# Date Prefix File Renamer

一个简单易用的文件重命名工具，自动为文件添加当前日期前缀。

## 功能特点

- 🗓️ 自动添加日期前缀（格式：`[YYMMDD]`）
- 🔄 智能检测并替换已有的日期前缀
- 🖱️ 支持Windows右键菜单集成
- 🖥️ 提供友好的图形界面
- ⚡ 支持命令行批量处理
- 🛡️ 防止文件名冲突

## 效果演示

```
原文件名：         test.cpp
重命名后：         [250624]test.cpp

原文件名：         document.pdf  
重命名后：         [250624]document.pdf

已有日期前缀：     [240101]old.txt
更新后：          [250624]old.txt
```

## 安装要求

- Windows 操作系统
- Python 3.6+
- tkinter（通常随Python自带）

## 使用方法

### 1. 图形界面模式

直接运行脚本启动GUI：（记得使用管理员模式）

```bash
python date_rename.py
```

GUI功能：
- **注册到右键菜单**：将工具添加到Windows文件右键菜单
- **从右键菜单移除**：移除右键菜单集成
- **测试重命名功能**：选择文件测试重命名效果
- 显示当前日期前缀示例

### 2. 右键菜单模式

1. 使用GUI注册右键菜单功能
2. 在任意文件上右键点击
3. 选择"添加日期前缀并重命名"
4. 文件将自动重命名

### 3. 命令行模式

```bash
python date_rename.py "文件路径"
```

示例：
```bash
python date_rename.py "C:\Users\Documents\report.docx"
```

## 日期格式说明

日期前缀格式：`[YYMMDD]`

- `YY`：年份后两位（如2025年 → 25）
- `MM`：月份（01-12）
- `DD`：日期（01-31）

示例：
- 2025年6月24日 → `[250624]`
- 2025年12月1日 → `[251201]`

## 功能详情

### 智能前缀管理
- 自动检测文件名中已存在的日期前缀
- 更新时替换旧前缀而非重复添加
- 支持格式：`[YYMMDD]`开头的任意6位数字

### 安全特性
- 重命名前检查目标文件是否已存在
- 避免意外覆盖文件
- 错误处理和用户友好的提示信息

### 右键菜单集成
- 支持Windows资源管理器右键菜单
- 需要管理员权限进行注册/注销
- 自动权限提升处理

## 文件结构

```
date_rename.py          # 主程序文件
README.md              # 说明文档
```

## 代码特点

- 纯Python实现，无需额外依赖
- 模块化设计，易于维护和扩展
- 完整的错误处理机制
- 支持中文界面和提示

## 注意事项

1. **管理员权限**：注册/移除右键菜单需要管理员权限
2. **文件安全**：重命名前会检查目标文件是否已存在
3. **路径限制**：建议避免在系统关键目录使用
4. **备份建议**：重要文件建议先备份再操作

## 常见问题

### Q: 为什么需要管理员权限？
A: 注册Windows右键菜单需要修改注册表，这需要管理员权限。

### Q: 如何批量重命名多个文件？
A: 可以编写批处理脚本调用命令行模式，或者逐个使用右键菜单。

### Q: 日期前缀会随时间自动更新吗？
A: 不会自动更新，需要手动重新运行工具来更新日期前缀。

### Q: 支持其他日期格式吗？
A: 当前固定为 `[YYMMDD]` 格式，如需其他格式可修改 `get_date_prefix()` 函数。

## 许可证

MIT License - 详见 [LICENSE](LICENSE) 文件

## 贡献

欢迎提交Issue和Pull Request！

1. Fork 本项目
2. 创建特性分支 (`git checkout -b feature/AmazingFeature`)
3. 提交更改 (`git commit -m 'Add some AmazingFeature'`)
4. 推送到分支 (`git push origin feature/AmazingFeature`)
5. 开启 Pull Request

## 作者

coperlm

## 更新日志

### v1.0.0
- 初始版本发布
- 支持日期前缀重命名
- GUI界面和右键菜单集成
- 命令行模式支持

---

⭐ 如果这个项目对您有帮助，请给一个Star！
